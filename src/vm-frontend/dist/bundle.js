!function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=15)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactRouterDOM},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(20);var s=n.default.createClass({displayName:"InnerMessager",getInitialState:function(){var e="正在加载";return isEmpty(this.props.defaultTip)||(e=this.props.defaultTip),{defaultTip:e,tip:"",cacheTip:"",tipPoint:".",tipPointMaxNum:4,tipPointNum:0,timer:void 0}},componentDidMount:function(){this.startLoopShowTipTimer(this.state.defaultTip)},stopLoopShowTipTimer:function(){var e=this.state;void 0!=e.timer&&(clearInterval(e.timer),e.timer=void 0),e.tip="",e.cacheTip="",this.setState(e)},startLoopShowTipTimer:function(e){var t=this.state;t.tip=t.cacheTip=e,this.setState(t),t=this.state,t.timer=setInterval(function(){var e=this.state,t=e.tip;e.tipPointNum>=e.tipPointMaxNum&&(t=e.cacheTip,e.tipPointNum=0),t+=e.tipPoint,e.tipPointNum=e.tipPointNum+1,e.tip=t,this.setState(e)}.bind(this),500),this.setState(t)},staticShowTip:function(e){var t=this.state;t.tip=e,this.setState(t)},componentWillUnmount:function(){this.stopLoopShowTipTimer()},showMsg:function(e,t){void 0==t&&(t=!0),this.stopLoopShowTipTimer(),void 0!=e&&""!=e&&(t?this.startLoopShowTipTimer(e):this.staticShowTip(e))},showDefaultMsg:function(e){this.showMsg(this.getDefaultMsg(),e)},getDefaultMsg:function(){return this.state.defaultTip},hide:function(){this.showMsg()},hideMsg:function(){this.showMsg()},render:function(){return n.default.createElement("div",{id:"tip"},this.state.tip)}});t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(25);var s=n.default.createClass({displayName:"PlainPanelTitle",getInitialState:function(){return{title:this.props.title}},render:function(){return n.default.createElement("div",{id:"plain_panel_title_content"},n.default.createElement("div",{id:"title_div"},this.state.title),n.default.createElement("div",{id:"split_line"}))}});t.default=s},function(e,t,i){"use strict";var a=i(0),n=(function(e){e&&e.__esModule}(a),i(14));window.eventEmit=new n.EventEmitter,window.VmFrontendEventsDispatcher={event:window.eventEmit,showMsgDialog:function(e,t){this.event.emit("showMsgDialog",e,t)},closeMsgDialog:function(){this.event.emit("closeMsgDialog")},showLoading:function(e){this.event.emit("showLoading",e)},closeLoading:function(){this.event.emit("closeLoading")},updateHeadComponentUser:function(e){this.event.emit("updateHeadComponentUser",e)},protectPage:function(){this.event.emit("protectPage")},getOnlineUser:function(e){this.event.emit("getOnlineUser",e)},feelerOnlineUser:function(e){this.event.emit("feelerOnlineUser",e)}},window.EventsDispatcher=window.VmFrontendEventsDispatcher;window.EventsDispatcher},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(28),i(4);var s=n.default.createClass({displayName:"MsgDialog",getInitialState:function(){var e="确认";return isEmpty(this.props.closeText)||(e=this.props.closeText),{closeText:e,dialogClassName:"",onCloseCallfun:void 0}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.adjustUI(),this.registEvents()},registEvents:function(){var e=this;window.eventEmit.on("showMsgDialog",function(t,i){var a=e.state;a.onCloseCallfun=i,e.setState(a),e.showMsg(t)}),window.eventEmit.on("closeMsgDialog",function(){e.close()})},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},showMsg:function(e){null!=e&&void 0!=e||(e="无消息"),$(this.refs.msg_p).html(e),this.fadeIn(),$(this.refs.close_btn).focus()},close:function(){this.fadeOut();var e=this.state.onCloseCallfun;isEmpty(e)||e()},fadeIn:function(){var e=this.state;$(this.refs.content).fadeIn(),e.dialogClassName="block animated headShake",this.setState(e)},fadeOut:function(){var e=this.state;e.dialogClassName="animated bounceOut",$(this.refs.content).fadeOut(),this.setState(e)},adjustUI:function(){this.dialogToMiddle()},dialogToMiddle:function(){var e=$(this.refs.dialog),t=$(this.refs.content),i=e.height(),a=t.height(),n=(a-i)/2;e.css("margin-top",n+"px")},handleCloseBtnKeyUp:function(e){13===e.keyCode&&this.close()},render:function(){return n.default.createElement("div",{id:"fragment_msg_dialog_content",ref:"content"},n.default.createElement("div",{id:"dialog",className:this.state.dialogClassName,ref:"dialog"},n.default.createElement("div",{id:"body"},n.default.createElement("span",{id:"msg_p",ref:"msg_p"},this.props.msg),n.default.createElement("span",{id:"split"},"|"),n.default.createElement("a",{id:"close_btn",ref:"close_btn",href:"javascript:void(0);",onClick:this.close,onKeyUp:this.handleCloseBtnKeyUp},this.state.closeText))))}});t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a),s=i(1);i(19);var o=n.default.createClass({displayName:"ActorsList",getInitialState:function(){return{whenThereHaveNotActor:"无相关演员"}},render:function(){var e=this.state.whenThereHaveNotActor,t=this.props.actors;if(!isEmptyList(t)){e="";for(var i=0;i<t.length;i++){e+=t[i].name,i!=t.length-1&&(e+=" / ")}}return n.default.createElement("span",{title:e},"主演：",isEmptyList(this.props.actors)?this.state.whenThereHaveNotActor:function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],o={pathname:"/filmmaker/"+a.id,state:{fromDashboard:!0}};i!=e.length-1?t.push(n.default.createElement("span",{key:a.id},n.default.createElement(s.Link,{className:"aLink",to:o},a.name)," / ")):t.push(n.default.createElement(s.Link,{key:a.id,className:"aLink",to:o},a.name))}return t}(this.props.actors))}});t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a),s=i(1);i(21);var o=n.default.createClass({displayName:"Director",getInitialState:function(){return{whenThereHaveNotDirector:"无相关导演"}},render:function(){var e=this;return n.default.createElement("span",null,function(t){if(isEmpty(t))return e.state.whenThereHaveNotDirector;var i={pathname:"/filmmaker/"+t.id,state:{fromDashboard:!0}};return n.default.createElement(s.Link,{title:t.name,id:"director_name",className:"aLink",to:i},n.default.createElement("span",null,"导演 : "),t.name)}(this.props.director))}});t.default=o},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=i(1),r=i(2),l=a(r),d=i(6),u=a(d),c=i(7),f=a(c);i(27);var m=s.default.createClass({displayName:"MoviesDisplayer",getInitialState:function(){return{loadingMoviesTip:"正在加载电影列表",noMoviesTip:"无相关电影"}},noMoviesTip:function(){this.showMsg(this.state.noMoviesTip,!1)},loadingMoviesTip:function(){this.showMsg(this.state.loadingMoviesTip,!0)},hideMovieTip:function(){this.refs.innerMessager.hide()},showMsg:function(e,t){this.refs.innerMessager.showMsg(e,t)},showDefaultMsg:function(e){this.refs.innerMessager.showDefaultMsg(e)},render:function(){var e=this.props.movies;isEmptyList(e)&&(e=[]);var t=e.map(function(e){var t={pathname:"/movie/"+e.id,state:{fromDashboard:!0}},i=generateImgUrl({imgUrl:e.imgUrl,width:300});return s.default.createElement("li",{className:"movie_item animated flipInX",key:e.id},s.default.createElement("div",{className:"movie_img_div"},s.default.createElement(o.Link,{to:t,className:"aLink"},s.default.createElement("img",{src:MOVIE_LOADING_IMG,"data-original":i}))),s.default.createElement("div",{className:"movie_info_div"},s.default.createElement("div",null,s.default.createElement(o.Link,{to:t,className:"aLink movie_name_a"},e.name)),s.default.createElement("div",{className:"movie_actor_list_div"},s.default.createElement(u.default,{actors:e.actors})),s.default.createElement("div",null,s.default.createElement(f.default,{director:e.director})),s.default.createElement("div",null,"评分：",e.score),s.default.createElement("div",null,"播放：",e.watchNum,"次")))}.bind(this));return s.default.createElement("ul",{id:"movies_list_ul"},s.default.createElement(l.default,{defaultTip:this.state.loadingMoviesTip,ref:"innerMessager"}),t,s.default.createElement("li",{className:"clear"}))}});t.default=m},function(e,t){e.exports=ReactDOM},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n);i(22);var o=i(2),r=a(o),l=s.default.createClass({displayName:"TagsOfMovie",getInitialState:function(){return{whenTagIsLoading:"正在加载标签信息",whenThereHaveNotTag:"无相关标签信息",movieId:this.props.movieId,tags:[]}},componentDidMount:function(){this.getTagsOfMovie()},getTagsOfMovie:function(e){var t="/tag/byMovieId/"+this.state.movieId;ajax.get({url:t,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){this.showTagTip()}.bind(this),onResponseSuccess:function(e){if(isEmptyList(e.data.list))return this.showTagTip(this.state.whenThereHaveNotTag,!1),void this.props.onLoadDataSuccess([]);var t=this.state;t.tags=e.data.list,this.setState(t),this.props.onLoadDataSuccess(t.tags)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this)})},showTagTip:function(e,t){this.refs.innerMessager.showMsg(e,t)},render:function(){return s.default.createElement("div",{id:"tags_of_movie"},s.default.createElement(r.default,{ref:"innerMessager",defaultTip:this.state.whenTagIsLoading}),s.default.createElement("div",{id:"ul_div"},s.default.createElement("ul",null,function(e){if(!isEmptyList(e)){for(var t=[],i=0;i<e.length;i++){var a=e[i];t.push(s.default.createElement("li",{className:"tag",key:a.id},s.default.createElement("a",{href:"javascript:void(0);"},a.name)))}return t}}(this.state.tags))))}});t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(23);var s=n.default.createClass({displayName:"FlexText",getInitialState:function(){var e=100;return isEmpty(this.props.maxTextLength)||(e=this.props.maxTextLength),{maxTextLength:e}},render:function(){var e=this.state.maxTextLength,t=this.props.text;isEmpty(t)&&(t="");var i=t;return e<t.length&&(i=t.substring(0,e)+"..."),n.default.createElement("div",{id:"flex_text_content",title:t},this.props.title,i)}});t.default=s},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=i(1),r=i(2),l=a(r);i(24);var d=i(3),u=a(d),c=s.default.createClass({displayName:"FilmmakersDetailsArea",getInitialState:function(){return{whenActorsDetailsIsLoading:"正在加载电影人信息",whenThereIsHaveNotFilmmakers:"无相关电影人",title:"相关演员"}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.getFilmmakers()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},getFilmmakers:function(){var e="/filmmaker/byMovieId/"+this.props.movieId;ajax.get({url:e,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){this.showTip()}.bind(this),onResponseSuccess:function(e){if(isEmptyList(e.data.filmmakers))return this.showTip(this.state.whenThereIsHaveNotFilmmakers,!1),void this.props.onLoadDataSuccess([]);var t=this.state;t.filmmakers=e.data.filmmakers,this.setState(t),this.adjustUI(),this.props.onLoadDataSuccess(t.filmmakers)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){}.bind(this)})},adjustUI:function(){var e=$(this.refs.actors_details_area),t=$(e.find("img")[0]).width(),i=t;e.find("img").height(i)},showTip:function(e,t){this.refs.actors_details_area_inner_messager.showMsg(e,t)},render:function(){var e=function(){var e=this.state.filmmakers,t=[];isEmptyList(e)&&(e=[]);for(var i=0;i<e.length;i++){var a=e[i],n={pathname:"/filmmaker/"+a.id,state:{fromDashboard:!0}},r=generateImgUrl({imgUrl:a.imgUrl,width:50});t.push(s.default.createElement("li",{key:a.id,title:a.name},s.default.createElement(o.Link,{title:a.name,to:n},s.default.createElement("img",{title:a.name,src:r}),s.default.createElement("div",{title:a.name},a.name))))}return t}.bind(this);return s.default.createElement("div",{id:"actors_details_area",ref:"actors_details_area"},s.default.createElement(u.default,{title:this.state.title}),s.default.createElement(l.default,{defaultTip:this.state.whenActorsDetailsIsLoading,ref:"actors_details_area_inner_messager"}),s.default.createElement("ul",null,e()))}});t.default=c},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n);i(26);var o=i(2),r=a(o),l=i(3),d=a(l),u=s.default.createClass({displayName:"MoviePlayer",getInitialState:function(){return{whenPlayerIsLoading:"正在加载视频资源",moviePlayerPanelTitle:"电影播放"}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.adjustUI()},componentWillReceiveProps:function(){this.props.movie,isUndefined(this.props.movie.id)||this.getMovieSrcVersion()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},adjustUI:function(){this.adjustMoviePlayerUI()},adjustMoviePlayerUI:function(){var e=$(this.refs.m_player),t=e.width(),i=t/1.5;e.height(i)},movieSharpness:function(e){return 1==e?"标清":2==e?"高清":3==e?"超清":void 0},getMovieSrcVersion:function(e){var t="/movie/version/"+this.props.movie.id+"?orderBy=weight&orderType=desc";ajax.get({url:t,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){this.showTip()}.bind(this),onResponseSuccess:function(e){for(var t=e.data.versions,i=[],a=0;a<t.length;a++){var n=t[a];i.push([generateUrl({url:n.srcUrl}),"video/mp4",this.movieSharpness(n.sharpness),n.weight])}i.push(["http://img.ksbbs.com/asset/Mon_1703/05cacb4e02f9d9e.mp4","video/mp4","1080",1080]);var s={},o=generateImgUrl({imgUrl:this.props.movie.posterUrl,obj:{width:600}});s.poster=o,s.video=i,setTimeout(function(){this.initPlayer(s)}.bind(this),10)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this)})},initPlayer:function(e){var t={container:"#m_player",variable:"player",poster:e.poster,autoplay:!1,volume:1,flashplayer:!0,video:e.video};new ckplayer(t)},showTip:function(e,t){this.refs.player_inner_messager.showMsg(e,t)},render:function(){return s.default.createElement("div",{id:"m"},s.default.createElement(d.default,{title:this.state.moviePlayerPanelTitle}),s.default.createElement(r.default,{defaultTip:this.state.whenPlayerIsLoading,ref:"player_inner_messager"}),s.default.createElement("div",{id:"m_player",ref:"m_player"}))}});t.default=u},function(e,t,i){e.exports=i(29)(1)},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(9),s=a(n),o=i(0),r=a(o),l=i(16),d=a(l);s.default.render(r.default.createElement(d.default,null),document.getElementById("react_dom_index"))},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(9),s=(a(n),i(0)),o=a(s),r=i(1),l=i(17),d=a(l);i(14);i(30);var u=i(31),c=a(u),f=i(36),m=a(f),h=i(38),p=a(h),v=i(44),g=a(v),E=i(5),w=a(E),_=i(46),M=a(_),T=i(48),I=a(T);i(4);var b=o.default.createClass({displayName:"Index",getInitialState:function(){return{}},render:function(){return o.default.createElement("div",{id:"index"},o.default.createElement(r.HashRouter,null,o.default.createElement("div",null,o.default.createElement(p.default,null),o.default.createElement(r.Switch,null,o.default.createElement(r.Route,{exact:!0,path:"/",render:function(){return o.default.createElement(c.default,{tagGroupSource:"/tagGroup/list",movieSource:"/movie/list"})}}),o.default.createElement(r.Route,{exact:!0,path:"/movie/list",render:function(){return o.default.createElement(c.default,{tagGroupSource:"/tagGroup/list",movieSource:"/movie/list"})}}),o.default.createElement(r.Route,{exact:!0,path:"/movie/:movieId",component:m.default}),o.default.createElement(r.Route,{exact:!0,path:"/filmmaker/:filmmakerId",component:d.default}),o.default.createElement(r.Route,{path:"/user/online",component:I.default})),o.default.createElement(g.default,null),o.default.createElement(w.default,{ref:"msg_dialog"}),o.default.createElement(M.default,null))))}});t.default=b},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n);i(18);var o=i(6),r=(a(o),i(2)),l=a(r),d=i(7),u=(a(d),i(10)),c=(a(u),i(11)),f=a(c),m=i(12),h=(a(m),i(13)),p=(a(h),i(8)),v=a(p),g=i(5),E=(a(g),i(3)),w=a(E);i(4);var _=s.default.createClass({displayName:"FilmmakerInfoPage",getInitialState:function(){return{whenFilmmakerInfoIsLoading:"正在加载电影人信息",filmmakerDescriptionTextLength:150,filmmakerDescriptionTitle:"电影人描述 : ",filmmaker:{},filmmakerUrl:this.props.match.url,filmmakerId:this.props.match.params.filmmakerId,aboutFilmmakersMovies:void 0,aboutFilmmakersMoviesPage:{size:10,start:0,orderBy:"score",orderType:"desc"}}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.getFilmmakerBasicInfo(),this.getAboutFilmmakerMovies([this.state.filmmakerId]),this.adjustUI()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},componentDidUpdate:function(){},componentWillReceiveProps:function(e){var t=this;isEmpty(this.props.match.url)||(this.props.history.push("/empty"),setTimeout(function(){t.props.history.replace(t.props.match.url)},1))},onWindowResize:function(){this.adjustUI()},adjustUI:function(){},lazyLoadImg:function(){lazyLoad()},getFilmmakerBasicInfo:function(e){var t=this.state.filmmakerUrl;ajax.get({url:t,onBeforeRequest:function(){this.showFilmmakerTip(this.state.whenFilmmakerInfoIsLoading)}.bind(this),onResponseStart:function(){this.showFilmmakerTip()}.bind(this),onResponseSuccess:function(e){var t=this.state;t.filmmaker=e.data.filmmaker,this.setState(t),this.lazyLoadImg()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this)})},showFilmmakerTip:function(e,t){this.refs.innerMessager.showMsg(e,t)},loadingAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.loadingMoviesTip()},hideAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.hideMovieTip()},noAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.noMoviesTip()},getAboutFilmmakerMovies:function(e){if(isEmptyList(e))return void this.noAboutFilmmakerMovies();var t=e,i=this.state.aboutFilmmakersMoviesPage.orderBy,a=this.state.aboutFilmmakersMoviesPage.orderType,n=this.state.aboutFilmmakersMoviesPage.size,s=this.state.aboutFilmmakersMoviesPage.start,o="/movie/about/filmmaker?orderBy="+i+"&orderType="+a+"&size="+n+"&start="+s;o=contactUrlWithArray(o,"filmmakerIds",t),ajax.get({url:o,onBeforeRequest:function(){this.loadingAboutFilmmakerMovies()}.bind(this),onResponseStart:function(){this.hideAboutFilmmakerMovies()}.bind(this),onResponseSuccess:function(e){if(isEmptyList(e.data.movies))return void this.noAboutFilmmakerMovies();var t=this.state;t.aboutFilmmakersMovies=e.data.movies,this.setState(t),this.lazyLoadImg()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){}.bind(this)})},render:function(){var e=timeFormatter.formatDate(this.state.filmmaker.birthday);return this.state.filmmaker.imgUrl,s.default.createElement("div",{id:"movie_info_content"},s.default.createElement("div",{id:"basic_info"},s.default.createElement("div",{className:"clearfix",id:"movie_info_displayer"},s.default.createElement("div",{id:"filmmaker_img"},s.default.createElement("img",{src:FILMMAKER_LOADING_IMG,"data-original":vm_config.http_url_prefix+this.state.filmmaker.imgUrl})),s.default.createElement("div",{id:"filmmaker_text"},s.default.createElement("ul",{id:"text_ul"},s.default.createElement(l.default,{defaultTip:this.state.whenFilmmakerInfoIsLoading,ref:"innerMessager"}),s.default.createElement("li",{id:"name_li"},"电影人 : ",s.default.createElement("a",{title:this.state.filmmaker.name,href:"javascript:void(0);"},this.state.filmmaker.name)),s.default.createElement("li",null,"别名 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.alias)),s.default.createElement("li",null,"血型 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.bloodType)),s.default.createElement("li",null,"职业 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.profession)),s.default.createElement("li",null,"星座 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.constellation)),s.default.createElement("li",null,"性别 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.sex)),s.default.createElement("li",null,"生日 : ",s.default.createElement("a",{href:"javascript:void(0);"},e)),s.default.createElement("li",null,"国家 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.filmmaker.country)),s.default.createElement("li",{id:"description_li"},s.default.createElement(f.default,{title:this.state.filmmakerDescriptionTitle,text:this.state.filmmaker.description,maxTextLength:this.state.filmmakerDescriptionTextLength})))))),s.default.createElement("div",{id:"about_filmmakers_movies"},s.default.createElement(w.default,{title:"电影人相关"}),s.default.createElement(v.default,{movies:this.state.aboutFilmmakersMovies,ref:"aboutFilmmakersMovies_MoviesDisplayer"})))}});t.default=_},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){e.exports=vendors_lib},function(e,t){},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=i(5),r=(a(o),i(2)),l=a(r),d=i(8),u=a(d),c=i(32),f=a(c);i(34),i(35),i(4);var m=s.default.createClass({displayName:"MovieTagGroup",render:function(){var e=this,t="";return void 0!=this.props.selected&&this.props.selected&&(t="currt"),s.default.createElement("div",{id:this.props.movieTagGroupId,className:"type_item"},s.default.createElement("label",null,this.props.movieTagGroupName,":"),s.default.createElement("ul",null,s.default.createElement("li",{className:t,onClick:function(){e.props.handleClickTag(void 0,e.props.movieTagGroupId)}},s.default.createElement("a",{href:"javascript:void(0);"},"全部")),this.props.movieTags.map(function(e){var t=this,i="";return void 0!=e.selected&&e.selected&&(i="currt"),s.default.createElement("li",{key:e.id,id:e.id,className:i,onClick:function(){t.props.handleClickTag(e.id,t.props.movieTagGroupId)}},s.default.createElement("a",{href:"javascript:void(0);"},e.name))}.bind(this))))}}),h=s.default.createClass({displayName:"MovieTagGroupList",getInitialState:function(){return{loadingTagTip:"正在加载标签列表",noTagTip:"无相关标签"}},noTagsTip:function(){this.showMsg(this.state.noTagTip,!1)},loadingTagsTip:function(){this.showMsg(this.state.loadingTagTip,!0)},hideTagTip:function(){this.refs.innerMessager.hide()},showMsg:function(e,t){this.refs.innerMessager.showMsg(e,t)},showDefaultMsg:function(e){this.refs.innerMessager.showDefaultMsg(e)},render:function(){return s.default.createElement("div",null,s.default.createElement(l.default,{defaultTip:this.state.loadingTagTip,ref:"innerMessager"}),this.props.movieTagGroup.map(function(e){return s.default.createElement(m,{key:e.id,handleClickTag:this.props.handleClickTag,movieTagGroupId:e.id,movieTagGroupName:e.name,selected:e.selected,movieTags:e.items})}.bind(this)))}}),p=s.default.createClass({displayName:"MovieListPage",getInitialState:function(){return{tagGroupSource:"/tagGroup/list",movieSource:"/movie/list",movieSearchBtnText:"搜索",whenThereIsHaveNotMovies:"无相关电影",whenThereIsHaveNotTags:"无相关标签",whenSearchRepeat:"重复搜索",lastKeyword:"",movieSearchTimer:void 0,movieTagGroup:[],movies:{keyword:"",total:0,list:void 0,page:1,size:20,orderType:"desc"},orderByOptions:[{id:"score",name:"最高评分",selected:!0},{id:"watch_num",name:"最多播放",selected:!1},{id:"release_time",name:"最新上映",selected:!1}]}},componentDidMount:function(){this.getTagGroup(this.getMovie),window.addEventListener("resize",this.onWindowResize)},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustMovieListUI()},adjustMovieListUI:function(){var e=$($(".movie_img_div a img")[0]).css("width"),t=1.5*parseInt(e);t=t.toString()+"px",$(".movie_img_div a img").css("height",t)},lazyLoadImg:function(){lazyLoad()},loadingMoviesTip:function(){this.refs.moviesDisplayer.loadingMoviesTip()},noMoviesTip:function(){this.refs.moviesDisplayer.noMoviesTip()},hideMovieTip:function(){this.refs.moviesDisplayer.hideMovieTip()},getMovie:function(e){for(var t,i=this.state.movies,a=i.page,n=i.size,s=i.orderType,o=(a-1)*n,r=i.keyword,l=0;l<this.state.orderByOptions.length;l++)if(this.state.orderByOptions[l].selected){t=this.state.orderByOptions[l].id;break}for(var d=[],l=0;l<this.state.movieTagGroup.length;l++){var u=this.state.movieTagGroup[l];if(!u.selected)for(var c=0;c<u.items.length;c++){var f=u.items[c];f.selected&&d.push(f.id)}}var m=this.state.movieSource+"?page="+a+"&start="+o+"&size="+n+"&orderBy="+t+"&orderType="+s+"&keyword="+r;m=contactUrlWithArray(m,"tagIds",d),ajax.get({url:m,onBeforeRequest:function(){this.loadingMoviesTip()}.bind(this),onResponseStart:function(){this.hideMovieTip()}.bind(this),onResponseSuccess:function(e){var t=this.state;t.movies.list=e.data.list,t.movies.total=e.data.total,this.setState(t),this.adjustMovieListUI(),this.lazyLoadImg(),isEmptyList(t.movies.list)&&this.noMoviesTip()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this)})},loadingTagsTip:function(){this.refs.movieTagGroupList.loadingTagsTip()},noTagsTip:function(){this.refs.movieTagGroupList.noTagsTip()},hideTagTip:function(){this.refs.movieTagGroupList.hideTagTip()},getTagGroup:function(e){ajax.get({url:this.state.tagGroupSource,onBeforeRequest:function(){this.loadingTagsTip()}.bind(this),onResponseStart:function(){this.hideTagTip()}.bind(this),onResponseSuccess:function(e){var t=this.state;t.movieTagGroup=e.data.list,isEmptyList(t.movieTagGroup)&&this.noTagsTip();for(var i=0;i<t.movieTagGroup.length;i++){t.movieTagGroup[i].selected=!0}this.setState(t)}.bind(this),onResponseFailure:function(t){window.VmFrontendEventsDispatcher.showMsgDialog(t.msg,function(){void 0!=e&&e()})}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this),onRequestError:function(){}.bind(this)})},handlePageChange:function(e){var t=this.state.movies.page+e;if(!(t<=0||this.state.movies.total-this.state.movies.size*(t-1)<=0)){var i=this.state;i.movies.page=t,this.setState(i),this.getMovie()}},handleClickTag:function(e,t){var i=this.state.movieTagGroup;if(void 0==e)for(var a=0;a<i.length;a++){var n=i[a];if(n.id==t){n.selected=!0;for(var s=0;s<n.items.length;s++){var o=n.items[s];o.selected=!1}}}else for(var a=0;a<i.length;a++){var n=i[a];if(n.id==t){n.selected=!1;for(var s=0;s<n.items.length;s++){var o=n.items[s];e==o.id?o.selected=!0:o.selected=!1}break}}var r=this.state;r.movies.page=1,r.movieTagGroup=i,this.setState(r),this.getMovie()},sortMovie:function(e){for(var t=this.state.orderByOptions,i=0;i<t.length;i++)t[i].id==e?t[i].selected=!0:t[i].selected=!1;var a=this.state;a.orderByOptions=t,this.setState(a),this.getMovie()},clearMovieSearchTimer:function(){this.state.movieSearchTimer&&clearTimeout(this.state.movieSearchTimer)},handleSearchInputChange:function(){this.clearMovieSearchTimer(),this.state.movieSearchTimer=setTimeout(function(){this.searchMovie()}.bind(this),1e3)},handleSearchInputKeyUp:function(e){13==e.keyCode&&(this.clearMovieSearchTimer(),this.searchMovie())},handleClickSearchBtn:function(){this.clearMovieSearchTimer(),this.searchMovie()},searchMovie:function(){var e=this.refs.keyword.value;if(this.state.lastKeyword==e)return void window.VmFrontendEventsDispatcher.showMsgDialog(this.state.whenSearchRepeat);var t=this.state.movieSearchBtnText,i=this.state;i.movieSearchBtnText="搜索中...",i.movies.keyword=e,i.movies.page=1,this.setState(i),this.getMovie(function(){this.state.lastKeyword=e,setTimeout(function(){var e=this.state;e.movieSearchBtnText=t,this.setState(e)}.bind(this,t),100)}.bind(this,e,t))},render:function(){var e=this;return s.default.createElement("div",{id:"fragment_index_center_content"},s.default.createElement("div",{id:"movie_type_div"},s.default.createElement(h,{handleClickTag:this.handleClickTag,movieTagGroup:this.state.movieTagGroup,ref:"movieTagGroupList"})),s.default.createElement("div",{id:"movie_list_div"},s.default.createElement("div",{id:"head"},s.default.createElement("div",{id:"sort_div"},s.default.createElement("ul",{id:"sort_ways"},s.default.createElement("label",null,"排序："),this.state.orderByOptions.map(function(t,i){var a="";return t.selected&&(a="currt"),s.default.createElement("li",{key:t.id,onClick:function(){e.sortMovie(t.id)},className:a},s.default.createElement("a",{href:"javascript:void(0);"},t.name))}))),s.default.createElement("div",{id:"search_div"},s.default.createElement("input",{id:"fragment_head_nav_search_text",onChange:function(){e.handleSearchInputChange()},onKeyUp:this.handleSearchInputKeyUp,ref:"keyword",placeholder:"请输入关键字"}),s.default.createElement("input",{id:"fragment_head_nav_search_btn",onClick:function(){e.handleClickSearchBtn()},ref:"movieSearchBtn",type:"button",value:this.state.movieSearchBtnText})),s.default.createElement("div",{id:"total_div"},"共",s.default.createElement("span",{id:"totalNum"},this.state.movies.total),"个结果"),s.default.createElement("div",{className:"clear"})),s.default.createElement("div",{id:"line"}),s.default.createElement("div",{id:"movies_display_div"},s.default.createElement(u.default,{movies:this.state.movies.list,ref:"moviesDisplayer"}),s.default.createElement(f.default,{handlePageChange:this.handlePageChange,page:this.state.movies.page}))))}});t.default=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(33);var s=n.default.createClass({displayName:"Pager",render:function(){var e=this;return n.default.createElement("div",{id:"movie_list_pager_div"},n.default.createElement("ul",{id:"movie_list_pager_ul"},n.default.createElement("li",{className:"pager_li"},n.default.createElement("a",{href:"javascript:void(0);",onClick:function(){e.props.handlePageChange(-1)}},"上一页")),n.default.createElement("li",{className:"pager_li currt"},n.default.createElement("a",{href:"javascript:void(0);"},this.props.page)),n.default.createElement("li",{className:"pager_li"},n.default.createElement("a",{href:"javascript:void(0);",onClick:function(){e.props.handlePageChange(1)}},"下一页"))))}});t.default=s},function(e,t){},function(e,t){},function(e,t){},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n);i(37);var o=i(6),r=a(o),l=i(2),d=a(l),u=i(7),c=a(u),f=i(10),m=a(f),h=i(11),p=a(h),v=i(12),g=a(v),E=i(13),w=a(E),_=i(8),M=a(_),T=i(5),I=(a(T),i(3)),b=a(I);i(4);var y=s.default.createClass({displayName:"MovieInfoPage",getInitialState:function(){return{movieDescriptionTitle:"电影简介 : ",whenMovieIsLoading:"加载电影信息",movieDescriptionTextLength:100,movie:{},movieUrl:this.props.match.url,targetMovieId:this.props.match.params.movieId,aboutFilmmakersMovies:void 0,aboutFilmmakersMoviesPage:{size:10,start:0,orderBy:"score",orderType:"desc"},aboutTagsMovies:void 0,aboutTagsMoviesPage:{size:10,start:0,orderBy:"score",orderType:"desc"}}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.getMovieBasicInfo(),this.adjustUI()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},componentDidUpdate:function(){},componentWillReceiveProps:function(e){var t=this;isEmpty(this.props.match.url)||(this.props.history.push("/empty"),setTimeout(function(){t.props.history.replace(t.props.match.url)},1))},onWindowResize:function(){this.adjustUI()},adjustUI:function(){},lazyLoadImg:function(){lazyLoad()},updateMovie:function(e){var t=this.state;t.movie=e,this.setState(t)},getMovieBasicInfo:function(e){var t=this.state.movieUrl;ajax.get({url:t,onBeforeRequest:function(){this.showMovieInfoTip(this.state.whenMovieIsLoading)}.bind(this),onResponseStart:function(){this.showMovieInfoTip()}.bind(this),onResponseSuccess:function(e){this.updateMovie(e.data.movie),this.lazyLoadImg()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this)})},showMovieInfoTip:function(e,t){this.refs.innerMessager.showMsg(e,t)},loadingAboutTagsMovies:function(){this.refs.aboutTagsMovies_MoviesDisplayer.loadingMoviesTip()},hideAboutTagsMovies:function(){this.refs.aboutTagsMovies_MoviesDisplayer.hideMovieTip()},noAboutTagsMovies:function(){this.refs.aboutTagsMovies_MoviesDisplayer.noMoviesTip()},getAboutTagsMovies:function(e){if(isEmptyList(e))return void this.noAboutTagsMovies();for(var t=[],i=0;i<e.length;i++)t.push(e[i].id);var a=this.state.aboutTagsMoviesPage.orderBy,n=this.state.aboutTagsMoviesPage.orderType,s=this.state.aboutTagsMoviesPage.size,o=this.state.aboutTagsMoviesPage.start,r="/movie/about/tag?orderBy="+a+"&orderType="+n+"&size="+s+"&start="+o+"&excludeMovieId="+this.state.targetMovieId;r=contactUrlWithArray(r,"tagIds",t),ajax.get({url:r,onBeforeRequest:function(){this.loadingAboutTagsMovies()}.bind(this),onResponseStart:function(){this.hideAboutTagsMovies()}.bind(this),onResponseSuccess:function(e){if(isEmptyList(e.data.movies))return void this.noAboutTagsMovies();var t=this.state;t.aboutTagsMovies=e.data.movies,this.setState(t),this.lazyLoadImg()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this)})},loadingAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.loadingMoviesTip()},hideAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.hideMovieTip()},noAboutFilmmakerMovies:function(){this.refs.aboutFilmmakersMovies_MoviesDisplayer.noMoviesTip()},getAboutFilmmakerMovies:function(e){if(isEmptyList(e))return void this.noAboutFilmmakerMovies();for(var t=[],i=0;i<e.length;i++)t.push(e[i].id);var a=this.state.aboutFilmmakersMoviesPage.orderBy,n=this.state.aboutFilmmakersMoviesPage.orderType,s=this.state.aboutFilmmakersMoviesPage.size,o=this.state.aboutFilmmakersMoviesPage.start,r="/movie/about/filmmaker?orderBy="+a+"&orderType="+n+"&size="+s+"&start="+o+"&excludeMovieId="+this.state.targetMovieId;r=contactUrlWithArray(r,"filmmakerIds",t),ajax.get({url:r,onBeforeRequest:function(){this.loadingAboutFilmmakerMovies()}.bind(this),onResponseStart:function(){this.hideAboutFilmmakerMovies()}.bind(this),onResponseSuccess:function(e){var t=this.state;t.aboutFilmmakersMovies=e.data.movies,this.setState(t),this.lazyLoadImg()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg)}.bind(this)})},render:function(){var e=timeFormatter.formatDate(this.state.movie.releaseTime),t=generateImgUrl({imgUrl:this.state.movie.imgUrl,width:300});return s.default.createElement("div",{id:"movie_info_content"},s.default.createElement("div",{id:"basic_info"},s.default.createElement("div",{className:"clearfix",id:"movie_info_displayer"},s.default.createElement("div",{id:"movie_img"},s.default.createElement("img",{src:MOVIE_LOADING_IMG,"data-original":t})),s.default.createElement("div",{id:"movie_text"},s.default.createElement("ul",{id:"text_ul"},s.default.createElement(d.default,{defaultTip:this.state.whenMovieIsLoading,ref:"innerMessager"}),s.default.createElement("li",{id:"name_li"},"电影 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.movie.name)),s.default.createElement("li",null,"别名 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.movie.alias)),s.default.createElement("li",null,"上映时间 : ",s.default.createElement("a",{href:"javascript:void(0);"},e)),s.default.createElement("li",null,"时长 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.movie.movieTime)," 分钟"),s.default.createElement("li",null,"评分 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.movie.score)),s.default.createElement("li",null,s.default.createElement(c.default,{director:this.state.movie.director})),s.default.createElement("li",null,s.default.createElement(r.default,{actors:this.state.movie.actors})),s.default.createElement("li",null,"总播放数 : ",s.default.createElement("a",{href:"javascript:void(0);"},this.state.movie.watchNum)," 次"),s.default.createElement("li",{id:"description_li"},s.default.createElement(p.default,{title:this.state.movieDescriptionTitle,text:this.state.movie.description,maxTextLength:this.state.movieDescriptionTextLength})),s.default.createElement("li",{id:"tags_li"},s.default.createElement(m.default,{movieId:this.state.targetMovieId,onLoadDataSuccess:this.getAboutTagsMovies})))))),s.default.createElement("div",{id:"movie_player",className:"clearfix"},s.default.createElement("div",{id:"m_wrapper",ref:"m_wrapper"},s.default.createElement(w.default,{movie:this.state.movie})),s.default.createElement("div",{id:"split"}),s.default.createElement("div",{id:"actors_details_div_wrapper"},s.default.createElement("div",{id:"actors_details_div"},s.default.createElement(g.default,{movieId:this.state.targetMovieId,onLoadDataSuccess:this.getAboutFilmmakerMovies})))),s.default.createElement("div",{id:"about_filmmakers_movies"},s.default.createElement(b.default,{title:"电影人相关"}),s.default.createElement(M.default,{movies:this.state.aboutFilmmakersMovies,ref:"aboutFilmmakersMovies_MoviesDisplayer"})),s.default.createElement("div",{id:"about_tags_movies"},s.default.createElement(b.default,{title:"标签相关"}),s.default.createElement(M.default,{movies:this.state.aboutTagsMovies,ref:"aboutTagsMovies_MoviesDisplayer"})))}});t.default=y},function(e,t){},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=i(1),r=i(39),l=a(r),d=i(41),u=a(d);i(43);var c=s.default.createClass({displayName:"Head",getInitialState:function(){return{logouting:"正在注销...",logoutSuccess:"注销成功",logoutFailure:"注销失败",tipOfOffLine:"您已离线",onlineUserBasicInfoUrl:"/user/online/basicInfo",protectedUserPageLists:["/user/[0-9/_-a-zA-Z]*"],user:{},pollOnlineUserStatusTimer:void 0,pollOnlineUserStatusTimerInterval:1e4,isFirstVisitPage:!0}},componentDidMount:function(){this.registEvents(),this.startPollOnlineUserStatus()},setIsFirstVisitPage:function(e){var t=this.state;t.isFirstVisitPage=e,this.setState(t)},stopPollOnlineUserStatus:function(){isUndefined(this.state.pollOnlineUserStatusTimer)||(clearInterval(this.state.pollOnlineUserStatusTimer),this.setPollOnlineUserStatusTimer(void 0))},startPollOnlineUserStatus:function(){if(isUndefined(this.state.pollOnlineUserStatusTimer)){this.pollOnlineUserStatus();var e=setInterval(function(){this.pollOnlineUserStatus()}.bind(this),this.state.pollOnlineUserStatusTimerInterval);this.setPollOnlineUserStatusTimer(e)}},pollOnlineUserStatus:function(){window.VmFrontendEventsDispatcher.feelerOnlineUser({onFeelerOnlineUser:function(e,t){window.VmFrontendEventsDispatcher.updateHeadComponentUser(t),e?this.closeLoginDialog():(this.stopPollOnlineUserStatus(),window.VmFrontendEventsDispatcher.protectPage(),this.state.isFirstVisitPage||window.VmFrontendEventsDispatcher.showMsgDialog(this.state.tipOfOffLine)),this.setIsFirstVisitPage(!1)}.bind(this)})},setPollOnlineUserStatusTimer:function(e){var t=this.state;t.pollOnlineUserStatusTimer=e,this.setState(t)},registEvents:function(){var e=this;window.eventEmit.on("updateHeadComponentUser",function(t){e.updateStateUser(t)}),window.eventEmit.on("feelerOnlineUser",function(t){ajax.get({url:"/user/feelerOnlineUser",ignoreAjaxError:!0,onBeforeRequest:function(){}.bind(e),onResponseStart:function(){}.bind(e),onResponseSuccess:function(e){var i=e.data.online,a=e.data.user;i||window.VmFrontendEventsDispatcher.protectPage(),isUndefined(t)||isUndefined(t.onFeelerOnlineUser)||t.onFeelerOnlineUser(i,a)}.bind(e),onResponseFailure:function(e){}.bind(e),onResponseEnd:function(){}.bind(e),onRequestError:function(){}.bind(e)})}),window.eventEmit.on("getOnlineUser",function(t){ajax.get({url:"/user/online",onBeforeRequest:function(){}.bind(e),onResponseStart:function(){}.bind(e),onResponseSuccess:function(e){var i=e.data.user;window.VmFrontendEventsDispatcher.updateHeadComponentUser(i),isUndefined(t)||isUndefined(t.onGetOnlineUser)||t.onGetOnlineUser(i)}.bind(e),onResponseFailure:function(e){}.bind(e),onResponseEnd:function(){}.bind(e),onRequestError:function(){}.bind(e)})}),window.eventEmit.on("protectPage",function(){for(var t=0;t<vm_config.protectedUserPageLists.length;t++){var i=vm_config.protectedUserPageLists[t];if(e.props.location.pathname,e.props.location.pathname.match(i)){e.props.history.replace("/");break}}window.VmFrontendEventsDispatcher.updateHeadComponentUser(void 0)})},showLoginDialog:function(){this.refs.login_dialog.showLoginDialog()},closeLoginDialog:function(){this.refs.login_dialog.closeLoginDialog()},onLoginSuccess:function(e){this.updateStateUser(e),this.startPollOnlineUserStatus()},showRegistDialog:function(){this.refs.regist_dialog.showRegistDialog()},closeRegistDialog:function(){this.refs.regist_dialog.closeRegistDialog()},onRegistSuccess:function(e){this.updateStateUser(e),this.startPollOnlineUserStatus()},updateStateUser:function(e){var t=this.state;isEmpty(e)?t.user={}:t.user=e,this.setState(t)},logout:function(){window.VmFrontendEventsDispatcher.showLoading(this.state.logouting);ajax.put({url:"/user/logout",onBeforeRequest:function(){}.bind(this),onResponseStart:function(){window.VmFrontendEventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(this.state.logoutSuccess),this.updateStateUser({}),window.VmFrontendEventsDispatcher.protectPage(),this.stopPollOnlineUserStatus()}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(this.state.logoutFailure)}.bind(this),onResponseEnd:function(){}.bind(this)})},render:function(){var e=function(){var e=this,t={pathname:this.state.onlineUserBasicInfoUrl},i=generateImgUrl({imgUrl:this.state.user.imgUrl,width:50});return s.default.createElement("span",null,s.default.createElement("li",null,s.default.createElement(o.Link,{id:"headImg_a",to:t},s.default.createElement("img",{id:"headImg_img",src:i}))),s.default.createElement("li",null,s.default.createElement(o.Link,{id:"username",to:t},this.state.user.username)),s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:void(0);",onClick:function(){e.logout()}},"注销")))}.bind(this),t=function(){return s.default.createElement("span",null,s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:void(0);",onClick:this.showLoginDialog},"登录")),s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:void(0);",onClick:this.showRegistDialog},"注册")))}.bind(this);return s.default.createElement("div",{id:"fragment_head_content"},s.default.createElement("div",{id:"nav_div"},s.default.createElement("ul",{id:"fragment_head_nav"},s.default.createElement("li",{id:"fragment_head_nav_logo"},s.default.createElement(o.Link,{to:"/"},s.default.createElement("span",{id:"logo_v"},"V"),s.default.createElement("span",{id:"logo_m"},"M"))),s.default.createElement("li",{id:"user_li"},s.default.createElement("ul",{id:"user_ul"},isEmpty(this.state.user)?t():e())))),s.default.createElement("div",{id:"blank_div"}),s.default.createElement(l.default,{ref:"login_dialog",onLoginSuccess:this.onLoginSuccess}),s.default.createElement(u.default,{ref:"regist_dialog",onRegistSuccess:this.onRegistSuccess}))}});t.default=(0,o.withRouter)(c)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(1);i(40);var s=n.default.createClass({displayName:"LoginDialog",getInitialState:function(){return{dialogClassName:"",logining:"正在登陆,请稍等..."}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.adjustUI()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},adjustUI:function(){this.dialogToMiddle()},dialogToMiddle:function(){var e=$(this.refs.dialog),t=$(this.refs.content),i=e.height(),a=t.height(),n=(a-i)/2;e.css("margin-top",n+"px")},showLoginDialog:function(){this.fadeIn(),this.adjustUI(),$(this.refs.username).focus()},closeLoginDialog:function(){this.fadeOut()},fadeIn:function(){var e=this.state;$(this.refs.content).fadeIn(),e.dialogClassName="block animated bounceIn",this.setState(e)},fadeOut:function(){var e=this.state;e.dialogClassName="animated bounceOut",$(this.refs.content).fadeOut(),this.setState(e)},login:function(){var e=$(this.refs.username).val(),t=$(this.refs.password).val(),i=$.extend({username:e,password:t},getVisitInfoObj());ajax.put({url:"/user/login",data:i,onBeforeRequest:function(){this.closeLoginDialog(),window.VmFrontendEventsDispatcher.showLoading(this.state.logining)}.bind(this),onResponseStart:function(){window.VmFrontendEventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){localStorage.setItem(KEY_OF_ACCESS_TOKEN,e.data.user.token),this.closeLoginDialog(),window.VmFrontendEventsDispatcher.showMsgDialog(e.msg),this.props.onLoginSuccess(e.data.user)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(e.msg,function(){this.showLoginDialog()}.bind(this))}.bind(this)})},handlePasswordKeyUp:function(e){13===e.keyCode&&this.login()},render:function(){return n.default.createElement("div",{id:"login_dialog_content",ref:"content"},n.default.createElement("div",{id:"dialog",className:this.state.dialogClassName,ref:"dialog"},n.default.createElement("div",{id:"head",className:"clearfix"},n.default.createElement("div",{id:"title_div"},"登录"),n.default.createElement("div",{id:"close_div"},n.default.createElement("a",{href:"javascript:void(0);",onClick:this.closeLoginDialog},"X"))),n.default.createElement("div",{id:"body"},n.default.createElement("div",{id:"login_form"},n.default.createElement("div",{id:"username_div"},n.default.createElement("input",{id:"username_input",type:"text",ref:"username",placeholder:"username"})),n.default.createElement("div",{id:"password_div"},n.default.createElement("input",{id:"password_input",type:"password",ref:"password",onKeyUp:this.handlePasswordKeyUp,placeholder:"password"})),n.default.createElement("div",{id:"login_btn_div"},n.default.createElement("input",{id:"login_btn_input",type:"button",value:"登录",onClick:this.login}))))))}});t.default=s},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(1);i(42);var s=n.default.createClass({displayName:"RegistDialog",getInitialState:function(){return{dialogClassName:"",registFailure:"注册失败",registSuccess:"注册成功",registing:"正在注册,请稍等..."}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.adjustUI()},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},adjustUI:function(){this.dialogToMiddle()},dialogToMiddle:function(){var e=$(this.refs.dialog),t=$(this.refs.content),i=e.height(),a=t.height(),n=(a-i)/2;e.css("margin-top",n+"px")},showRegistDialog:function(){this.fadeIn(),this.adjustUI(),$(this.refs.username).focus()},closeRegistDialog:function(){this.fadeOut()},fadeIn:function(){var e=this.state;$(this.refs.content).fadeIn(),e.dialogClassName="block animated bounceIn",this.setState(e)},fadeOut:function(){var e=this.state;e.dialogClassName="animated bounceOut",$(this.refs.content).fadeOut(),this.setState(e)},regist:function(){var e=$(this.refs.username).val(),t=$(this.refs.password).val(),i="/user/regist?username="+e+"&password="+t;ajax.put({url:i,onBeforeRequest:function(){this.closeRegistDialog(),window.VmFrontendEventsDispatcher.showLoading(this.state.registing)}.bind(this),onResponseStart:function(){window.VmFrontendEventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){this.closeRegistDialog(),localStorage.setItem(KEY_OF_ACCESS_TOKEN,e.data.user.token),window.VmFrontendEventsDispatcher.showMsgDialog(this.state.registSuccess),this.props.onRegistSuccess(e.data.user)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(this.state.registFailure,function(){this.showRegistDialog()}.bind(this))}.bind(this)})},handlePasswordKeyUp:function(e){13===e.keyCode&&this.regist()},render:function(){return n.default.createElement("div",{id:"regist_dialog_content",ref:"content"},n.default.createElement("div",{id:"dialog",className:this.state.dialogClassName,ref:"dialog"},n.default.createElement("div",{id:"head",className:"clearfix"},n.default.createElement("div",{id:"title_div"},"注册"),n.default.createElement("div",{id:"close_div"},n.default.createElement("a",{href:"javascript:void(0);",onClick:this.closeRegistDialog},"X"))),n.default.createElement("div",{id:"body"},n.default.createElement("div",{id:"regist_form"},n.default.createElement("div",{id:"username_div"},n.default.createElement("input",{id:"username_input",type:"text",ref:"username",placeholder:"username"})),n.default.createElement("div",{id:"password_div"},n.default.createElement("input",{id:"password_input",type:"password",ref:"password",onKeyUp:this.handlePasswordKeyUp,placeholder:"password"})),n.default.createElement("div",{id:"regist_btn_div"},n.default.createElement("input",{id:"regist_btn_input",type:"button",value:"注册",onClick:this.regist}))))))}});t.default=s},function(e,t){},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(45);var s=n.default.createClass({displayName:"Tail",render:function(){return n.default.createElement("div",{id:"fragment_tail_content"},n.default.createElement("img",{src:"/image/tail.png"}))}});t.default=s},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(1);i(47);var s=n.default.createClass({displayName:"Loading",getInitialState:function(){return{dialogClassName:"",nowMsg:"",defaultMsg:"请稍等..."}},componentDidMount:function(){window.addEventListener("resize",this.onWindowResize),this.adjustUI(),this.registEvents()},registEvents:function(){var e=this;window.eventEmit.on("showLoading",function(t){e.showLoading(t)}),window.eventEmit.on("closeLoading",function(){e.closeLoading()})},componentWillUnmount:function(){window.removeEventListener("resize",this.onWindowResize)},onWindowResize:function(){this.adjustUI()},adjustUI:function(){this.dialogToMiddle()},dialogToMiddle:function(){var e=$(this.refs.dialog),t=$(this.refs.content),i=e.height(),a=t.height(),n=(a-i)/2;e.css("margin-top",n+"px")},updateStateNowMsg:function(e){var t=this.state;t.nowMsg=e,this.setState(t)},showLoading:function(e){isEmpty(e)?this.updateStateNowMsg(this.state.defaultMsg):this.updateStateNowMsg(e),this.fadeIn(),this.adjustUI()},closeLoading:function(){this.fadeOut()},fadeIn:function(){var e=this.state;$(this.refs.content).fadeIn(),e.dialogClassName="block animated bounceIn",this.setState(e)},fadeOut:function(){var e=this.state;e.dialogClassName="animated bounceOut",$(this.refs.content).fadeOut(),this.setState(e)},render:function(){return n.default.createElement("div",{id:"loading_content",ref:"content"},n.default.createElement("div",{id:"dialog",ref:"dialog",className:this.state.dialogClassName},n.default.createElement("img",{src:"/image/loading.gif"}),n.default.createElement("div",null,this.state.nowMsg)))}});t.default=s},function(e,t){},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=i(1),r=i(3),l=a(r),d=i(49),u=a(d),c=i(53),f=a(c);i(57);var m=s.default.createClass({displayName:"UserPage",getInitialState:function(){return{basicInfoUrl:"/user/online/basicInfo",headUrl:"/user/online/head"}},componentDidMount:function(){},render:function(){return window.VmFrontendEventsDispatcher.feelerOnlineUser(),s.default.createElement("div",{id:"user_info",className:"defaultPanel"},s.default.createElement(l.default,{title:this.state.title}),s.default.createElement("div",{id:"content",className:"clearfix"},s.default.createElement("div",{id:"nav"},s.default.createElement("ul",{id:"nav_ul"},s.default.createElement("li",null,s.default.createElement(o.NavLink,{to:this.state.basicInfoUrl,activeClassName:"active"},"基本信息")),s.default.createElement("li",null,s.default.createElement(o.NavLink,{to:this.state.headUrl,activeClassName:"active"},"头像修改")))),s.default.createElement("div",{id:"displayer"},s.default.createElement(o.Switch,null,s.default.createElement(o.Route,{exact:!0,path:this.state.basicInfoUrl,component:u.default}),s.default.createElement(o.Route,{exact:!0,path:this.state.headUrl,component:f.default})))))}});t.default=(0,o.withRouter)(m)},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n),o=(i(1),i(50)),r=a(o);i(52);var l=s.default.createClass({displayName:"UserBasicInfoPage",getInitialState:function(){return{getInfoFailure:"获取信息失败",title:"用户个人信息",updateUserBasicInfoSuccess:"更新用户信息成功",updateUserBasicInfoFailure:"更新用户信息失败",updatingUserBasicInfo:"正在更新用户信息",user:{}}},componentDidMount:function(){window.VmFrontendEventsDispatcher.getOnlineUser({onGetOnlineUser:function(e){this.updateStateUser(e)}.bind(this)})},updateStateUser:function(e){isEmpty(e)&&(e={});var t=this.state;t.user=e,this.setState(t)},handleBirthdayChange:function(e){var t=parseInt(e.getTime())/1e3;this.updateUserBirthday(t.toFixed(0))},updateUserBirthday:function(e){var t=this.state.user;t.birthday=e,this.updateStateUser(t)},updateUserBasicInfo:function(e){window.EventsDispatcher.showLoading(this.state.updatingUserBasicInfo);ajax.put({url:"/user/online",data:this.state.user,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){window.EventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){var t=e.data.user;this.updateStateUser(t),window.VmFrontendEventsDispatcher.showMsgDialog(this.state.updateUserBasicInfoSuccess)}.bind(this),onResponseFailure:function(e){window.VmFrontendEventsDispatcher.showMsgDialog(this.state.updateUserBasicInfoFailure)}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this,e)})},handleUsernameChange:function(e){e.target.value},updateStateUsername:function(e){var t=this.state.user;t.username=e,this.updateStateUser(t)},handleDescriptionChange:function(e){var t=e.target.value;this.updateStateDescription(t)},updateStateDescription:function(e){var t=this.state.user;t.description=e,this.updateStateUser(t)},handleSexChange:function(e){var t=e.target.value;this.updateStateSex(t)},updateStateSex:function(e){var t=this.state.user;t.sex=e,this.updateStateUser(t)},render:function(){var e=this,t=parseInt(this.state.user.birthday),i=new Date(1e3*t);return s.default.createElement("div",{id:"user_basic_info_content",className:"clearfix"},s.default.createElement("div",{id:"basic_info"},s.default.createElement("form",null,s.default.createElement("div",{id:"displayer"},s.default.createElement("div",{id:"username_div",className:"info_item clearfix"},s.default.createElement("label",null,"昵称 : "),s.default.createElement("span",{className:"split"}),s.default.createElement("span",{className:"content"},s.default.createElement("input",{onChange:this.handleUsernameChange,value:this.state.user.username}))),s.default.createElement("div",{id:"sex_div",className:"info_item clearfix"},s.default.createElement("label",null,"性别 : "),s.default.createElement("span",{className:"split"}),s.default.createElement("span",{className:"content"},s.default.createElement("select",{defaultValue:this.state.user.sex,value:this.state.user.sex,onChange:this.handleSexChange},s.default.createElement("option",{value:"1"},"男"),s.default.createElement("option",{value:"2"},"女"),s.default.createElement("option",{value:"3"},"保密")))),s.default.createElement("div",{id:"birthday_div",className:"info_item clearfix"},s.default.createElement("label",null,"生日 : "),s.default.createElement("span",{className:"split"}),s.default.createElement("span",{className:"content"},s.default.createElement(r.default,{defaultDate:i,onDateChange:this.handleBirthdayChange}))),s.default.createElement("div",{id:"description_div",className:"info_item clearfix"},s.default.createElement("label",null,"描述 : "),s.default.createElement("span",{className:"split"}),s.default.createElement("span",{className:"content"},s.default.createElement("textarea",{placeholder:"请输入描述信息",onChange:this.handleDescriptionChange,value:this.state.user.description}))),s.default.createElement("div",{id:"confirm_div"},s.default.createElement("input",{type:"button",onClick:function(){e.updateUserBasicInfo()},value:"确定"}))))),s.default.createElement("div",{id:"tip"},s.default.createElement("p",null,"请您完善账户基本信息")))}});t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(51);var s=n.default.createClass({displayName:"Dater",getInitialState:function(){var e=new Date,t=e.getFullYear(),i=t-100;!isEmpty(this.props.minYear)&&this.props.minYear<=t&&(i=this.props.minYear);for(var a=[],n=t;n>=i;n--)a.push(n);for(var s=[],n=1;n<=12;n++)s.push(n);for(var o=[],r=e.getCountOfMonthDay(),n=1;n<=r;n++)o.push(n);return{years:a,months:s,days:o,now:e,minYear:i,maxYear:t}},splitDate:function(e){var t=void 0;if(!isUndefined(e)){t={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}return t},componentDidMount:function(){},getDate:function(){var e=$(this.refs.year).val(),t=$(this.refs.month).val(),i=$(this.refs.day).val(),a=new Date;return a.setFullYear(e),a.setMonth(t-1),a.setDate(i),a},generateOptions:function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i];t.push(n.default.createElement("option",{key:a,value:a},a))}return t},render:function(){var e=this,t=this.state.now,i={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()};return isUndefined(this.props.defaultDate)||(i=this.splitDate(this.props.defaultDate)),n.default.createElement("span",{id:"date_content"},n.default.createElement("span",null,n.default.createElement("select",{id:"year",ref:"year",defaultValue:"",value:i.year,onChange:function(){e.props.onDateChange(e.getDate())}},this.generateOptions(this.state.years)),"年"),n.default.createElement("span",null,n.default.createElement("select",{id:"month",ref:"month",defaultValue:"",value:i.month,onChange:function(){e.props.onDateChange(e.getDate())}},this.generateOptions(this.state.months)),"月"),n.default.createElement("span",null,n.default.createElement("select",{id:"day",ref:"day",defaultValue:"",value:i.day,onChange:function(){e.props.onDateChange(e.getDate())}},this.generateOptions(this.state.days)),"日"))}});t.default=s},function(e,t){},function(e,t){},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=a(n);i(54);var o=i(55),r=a(o),l=s.default.createClass({displayName:"UserHeadPage",getInitialState:function(){return{config:{aspectRatio:1,fileTypes:["jpg","png"],fileMaxsize:1048576,saveImgUrl:"/user/online/img",uploadTempImgUrl:"/src/img"},getInfoFailure:"获取信息失败",userHeadRequestWidth:300,user:{}}},componentDidMount:function(){window.VmFrontendEventsDispatcher.getOnlineUser({onGetOnlineUser:function(e){var t=generateImgUrl({imgUrl:e.imgUrl,width:this.state.userHeadRequestWidth});this.getUserHeadUploader().previewImg(t)}.bind(this)})},getUserHeadUploader:function(){return this.refs.userHeadUploader},previewHeadImg:function(e){this.getUserHeadUploader().previewImg(e)},onUpdateImgSuccess:function(e){this.getUserHeadUploader().previewImg(generateImgUrl({imgUrl:e.data.imgUrl,width:300})),window.EventsDispatcher.updateHeadComponentUser(e.data.user)},onUploadTempImgSuccess:function(e){this.getUserHeadUploader().previewImg(generateImgUrl({imgUrl:e.data.imgUrl}))},render:function(){return s.default.createElement("div",{id:"user_head_content",className:"clearfix"},s.default.createElement("div",{id:"react_img_uploader"},s.default.createElement(r.default,{ref:"userHeadUploader",config:this.state.config,onUpdateImgSuccess:this.onUpdateImgSuccess,onUploadTempImgSuccess:this.onUploadTempImgSuccess})),s.default.createElement("div",{id:"tip"},s.default.createElement("p",null,"在这里可以上传您的头像")))}});t.default=l},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a);i(56);var s=n.default.createClass({displayName:"ImgUpload",getInitialState:function(){var e=this.props.config;return{config:e,uploadTempImgTip:"正在读取图片",saveImg:"正在保存图片",userImgFileTooMax:"文件过大,最大允许 : "+e.fileMaxsize/1024+" kb",userImgFileExtError:"文件类型错误,允许的文件类型 : "+e.fileTypes,userImgFileIsEmpty:"请选择一个文件",userImgUpdateSuccess:"图片更新成功",willUpdatedImgInfo:{fileId:void 0},$imgPreview:void 0}},componentDidMount:function(){},validateImgFileOnSubmit:function(){if(isUndefined(this.state.willUpdatedImgInfo.fileId))throw this.state.userImgFileIsEmpty},validateImgFileOnChoice:function(e){if(isUndefined(e)||isUndefined(e.size))throw this.state.userImgFileIsEmpty;if(e.size>this.state.config.fileMaxsize)throw this.state.userImgFileTooMax;var t=getFileNameExt(e.name);if(!this.state.config.fileTypes.contains(t))throw this.state.userImgFileExtError},getImgInput:function(){return $(this.refs.imgInput)},getImgFile:function(){return this.getImgInput().get(0).files[0]},updateStateImgPreview:function(e){var t=this.state;t.$imgPreview=e,this.setState(t)},previewImg:function(e){setTimeout(function(){this.previewImgWait(e)}.bind(this))},previewImgWait:function(e){var t=function(e){var t=this.state.willUpdatedImgInfo;t.x=Math.round(e.x),t.y=Math.round(e.y),t.height=Math.round(e.height),t.width=Math.round(e.width),t.rotate=Math.round(e.rotate),t.scaleX=Math.round(e.scaleX),t.scaleY=Math.round(e.scaleY);var i=this.state;return i.willUpdatedImgInfo=t,this.setState(i),t}.bind(this),i=$(".preview"),a={aspectRatio:this.state.config.aspectRatio,viewMode:2,ready:function(e){var t=$(this).clone().removeClass("cropper-hidden");t.css({display:"block",width:"100%",minWidth:0,minHeight:0,maxWidth:"none",maxHeight:"none"}),i.css({width:"100%",overflow:"hidden"}).html(t)},cropstart:function(e){},cropmove:function(e){},cropend:function(e){},crop:function(e){t(e);var a=$(this).cropper("getImageData"),n=e.width/e.height;i.each(function(){var t=$(this),i=t.width(),s=i/n,o=e.width/i;t.height(s).find("img").css({width:a.naturalWidth/o,height:a.naturalHeight/o,marginLeft:-e.x/o,marginTop:-e.y/o})})},zoom:function(e){e.type,e.ratio}};if(isUndefined(this.state.$imgPreview)){var n=$(this.refs.imgPreview);n.cropper(a),this.updateStateImgPreview(n)}this.state.$imgPreview.cropper("replace",e)},uploadTempImg:function(e){var t=(this.getImgInput(),this.getImgFile());try{this.validateImgFileOnChoice(t)}catch(e){return void window.EventsDispatcher.showMsgDialog(e)}window.EventsDispatcher.showLoading(this.state.uploadTempImgTip);var i=new FormData;i.append("file",t);var a=this.state.config.uploadTempImgUrl;ajax.post({url:a,data:i,enctype:"multipart/form-data",contentType:!1,processData:!1,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){window.EventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){this.updateTempFileId(e.data.fileId),this.props.onUploadTempImgSuccess(e)}.bind(this),onResponseFailure:function(e){}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this),onRequestError:function(){}.bind(this)})},updateTempFileId:function(e){var t=this.state;t.willUpdatedImgInfo.fileId=e,this.setState(t)},clearImgInput:function(){this.getImgInput().val("")},saveImg:function(e){try{this.validateImgFileOnSubmit()}catch(e){return void window.EventsDispatcher.showMsgDialog(e)}window.EventsDispatcher.showLoading();var t=this.state.config.saveImgUrl,i=this.state.willUpdatedImgInfo;ajax.put({url:t,data:i,loadingMsg:this.state.saveImg,onBeforeRequest:function(){}.bind(this),onResponseStart:function(){window.EventsDispatcher.closeLoading()}.bind(this),onResponseSuccess:function(e){window.EventsDispatcher.showMsgDialog(this.state.userImgUpdateSuccess),this.updateTempFileId(void 0),this.clearImgInput(),this.props.onUpdateImgSuccess(e)}.bind(this),onResponseFailure:function(e){}.bind(this),onResponseEnd:function(){void 0!=e&&e()}.bind(this),onRequestError:function(){}.bind(this)})},render:function(){var e=this;return n.default.createElement("div",{id:"img_uploader",className:"clearfix"},n.default.createElement("div",{id:"img_upload"},n.default.createElement("div",{id:"img_upload_to_middle_div"},n.default.createElement("div",{id:"imgPreviewWrapper",ref:"imgPreviewWrapper"},n.default.createElement("img",{src:"",id:"imgPreview",ref:"imgPreview"})),n.default.createElement("div",{id:"btns_div"},n.default.createElement("input",{type:"file",ref:"imgInput",name:"img",id:"imgInput",onChange:function(){e.uploadTempImg()}}),n.default.createElement("input",{type:"button",className:"operateBtn",id:"uploadTempImgBtn",value:"选择图片",onClick:function(){e.refs.imgInput.click()}}),n.default.createElement("input",{type:"button",className:"operateBtn",id:"imgSaveBtn",ref:"imgSaveBtn",onClick:function(){e.saveImg()},value:"保存"})))),n.default.createElement("div",{id:"head_preview"},n.default.createElement("p",null,"预览 : "),n.default.createElement("div",{id:"imgPreview0"},n.default.createElement("div",{className:"preview"}),"80x"),n.default.createElement("div",{id:"imgPreview1"},n.default.createElement("div",{className:"preview"}),"50x"),n.default.createElement("div",{id:"imgPreview2"},n.default.createElement("div",{className:"preview"}),"30x")))}});t.default=s},function(e,t){},function(e,t){}]);